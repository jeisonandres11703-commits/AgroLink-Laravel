<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AgroLink - Vehiculos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/styleAsesor.css">
</head>

<body class="bg-light text-dark">
    <!-- Barra de navegación -->
    <div class="barranav">
        <nav class="navbar navbar-expand-lg navbar-dark" style="background:#1a512e;" data-bs-theme="light w-100">
            <div class="container-fluid">
                <a class="navbar-brand me-5" href="enviosDashboard.html">Agrolink</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="enviosDashboard.html">Envios disponibles </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="">Cerrar sesión</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>

    <!-- Contenido principal -->
    <main class="container py-5">
    
        <!-- Tarjetas de servicios -->
        <section>
            <h2 class="h4 fw-bold mb-4">Mis vehiculos registrados </h2>
            <div class="row g-4" id="contenedor-tarjetas">
                <!-- Tarjeta 1 -->
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body view-mode">
                            <h5 class="card-title"><strong>Camioneta</strong></h5>
                            <br>
                            <p class="card-text"><strong>Placa: </strong> URM-458</p>
                            <p class="card-text"><strong>Capacidad:</strong> 1.800 (Kg)</p>
                            <div class="d-flex gap-2">
                                <button class="btn btn-success edit-btn">Suspender vehiculo</button>
                                <button class="btn btn-danger delete-btn">Eliminar vehiculo</button>
                            </div>
                        </div>
                        <div class="card-body edit-mode">

                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-success ">Activar vehiculo</button>

                            </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Tarjeta 2 -->
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body view-mode">
                            <h5 class="card-title"><strong>Van</strong></h5>
                            <br>
                            <p class="card-text"><strong>Placa: </strong> UXP-656</p>
                            <p class="card-text"><strong>Capacidad:</strong> 1.000 (Kg)</p>
                            <div class="d-flex gap-2">
                                <button class="btn btn-success edit-btn">Suspender vehiculo</button>
                                <button class="btn btn-danger delete-btn">Eliminar vehiculo</button>
                            </div>
                        </div>
                        <div class="card-body edit-mode">

                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-success ">Activar vehiculo</button>

                            </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <br>
        <br>
        <br>
        <!-- Formulario de publicación -->
        <section class="mb-5">
            <h2 class="h4 fw-bold mb-4">Agregar un vehiculo </h2>
            <form class="row g-3" id="formPublicar">
                <div class="col-md-6">
                    <select class="form-select form-select-lg mb-3" id="tipoVehiculo" style="font-size: medium;"
                        aria-label="Large select example">
                        <option selected disabled>Tipo de vehiculo</option>
                        <option value="1">Camión</option>
                        <option value="2">Camioneta</option>
                        <option value="3">Van</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <input type="text" class="form-control" id="placa" placeholder="Ingresa La Placa Del Vehiculo"
                        required />
                </div>

                <div class="row g-3" style="display: flex; justify-content: space-between;">
                    <!-- Fila para el rango y los archivos -->
                    <div class="col-md-6" style="width: 300px;">
                        <div class="mb-3">
                            <label class="form-label">Capacidad maxima (kg)</label>
                            <input type="range" class="form-range peso-slider" min="0" max="15000" step="100" value="0">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <small class="text-muted">0 kg</small>
                                <span class="badge bg-success valor-peso">0 kg</span>
                                <small class="text-muted">15000 kg</small>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="formFileMultiple" class="form-label">Documentos del vehículo</label>
                            <input class="form-control" type="file" id="formFileMultiple" multiple>
                            <div class="form-text">Sube fotos del SOAT y tarjeta de propiedad</div>
                        </div>
                    </div>
                </div>

                <div class="col-12" >
                    <button type="submit" class="btn btn-success w-100 fw-semibold">Agregar vehiculo</button>
                </div>
            </form>
        </section>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>

        function crearTarjeta(tipo, placa, capacidad) {
            const nuevaTarjeta = `
        <div class="col-md-6" >
          <div class="card shadow-sm">
            <div class="card-body view-mode">
              <h5 class="card-title"><strong>${tipo}</stong></h5>
              <br>
              <p class="card-text"><strong>Placa:</strong> ${placa}</p>
              <p class="card-text"><strong>Capacidad </strong> ${capacidad} (Kg)</p>
              <div class="d-flex gap-2">
                <button class="btn btn-success edit-btn">Suspender Vehiculo</button>
                <button class="btn btn-danger delete-btn">Eliminar</button>
              </div>
            </div>
            <div class="card-body edit-mode">
              <form class="edit-form">
                <div class="mb-3">
                  <input type="text" class="form-control" value="${tipo}" required>
                </div>
                <div class="mb-3">
                  <input type="text" class="form-control" value="${placa}" required>
                </div>
                <div class="mb-3">
                  <textarea class="form-control" rows="3" required>${capacidad}</textarea>
                </div>
                <div class="d-flex gap-2">
                  <button type="submit" class="btn btn-primary">Guardar</button>
                  <button type="button" class="btn btn-secondary cancel-btn">Cancelar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      `;

            document.getElementById('contenedor-tarjetas').insertAdjacentHTML('beforeend', nuevaTarjeta);
            asignarEventosATarjeta(document.getElementById('contenedor-tarjetas').lastElementChild);
        };

        // Función para asignar eventos a una tarjeta
        function asignarEventosATarjeta(tarjeta) {

            // Eliminar tarjeta
            tarjeta.querySelector('.delete-btn')?.addEventListener('click', (e) => {
                if (confirm('¿Estás seguro de eliminar este servicio?')) {
                    e.target.closest('.col-md-6').remove();
                }
            });

        }

        //Evento para el slider de capacidad
        document.querySelector('.peso-slider').addEventListener('input', function (e) {
            actualizarValorSlider(e.target.value);
        });

        // Funcion Para Actualizar el valor del slider 
        function actualizarValorSlider(valor) {
            document.querySelector('.valor-peso').textContent = `${valor} kg`;
        }

        function mostrarError(mensaje) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'alert alert-danger';
            errorDiv.textContent = mensaje;

            formPublicar.prepend(errorDiv);

            setTimeout(() => errorDiv.remove(), 3000);
        }


        // Evento para el formulario de publicación
        document.getElementById('formPublicar').addEventListener('submit', (e) => {
            e.preventDefault();
            const tipoSelect = e.target.querySelector('#tipoVehiculo');
            const placaInput = e.target.querySelector('#placa');
            const cargaSlider = e.target.querySelector('.peso-slider');


            // obtengo los valores

            const tipo = tipoSelect.options[tipoSelect.selectedIndex].text;
            const placa = placaInput.value
            const carga = cargaSlider.value

            if (tipo && placa && carga) {
                crearTarjeta(tipo, placa, carga);
                e.target.reset();
            } else {
                alert('Por favor completa todos los campos requeridos.');
            }
        });




    </script>
</body>

</html>